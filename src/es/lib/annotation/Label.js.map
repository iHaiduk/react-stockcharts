{"version":3,"sources":["../../../../src/lib/annotation/Label.js"],"names":["React","Component","PropTypes","GenericComponent","isDefined","hexToRGBA","functor","LabelAnnotation","defaultProps","helper","Label","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","drawOnCanvas2","context","selectCanvas","chartConfig","getYScale","getText","text","Array","isArray","undefined","yScale","contextTypes","canvasOriginX","number","canvasOriginY","margin","object","isRequired","ratio","canvases","bg","save","setTransform","scale","translate","left","top","restore","textAnchor","fontFamily","fontSize","opacity","rotate","xScale","xAccessor","xPos","yPos","fill","radians","Math","PI","font","fillStyle","textAlign","beginPath","fillText"],"mappings":"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","file":"Label.js","sourcesContent":["\"use strict\";\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport GenericComponent from \"../GenericComponent\";\n\nimport { isDefined, hexToRGBA, functor } from \"../utils\";\nimport LabelAnnotation, { defaultProps, helper } from \"./LabelAnnotation\";\n\nclass Label extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tdrawOnCanvas2(ctx, this.props, this.context, moreProps);\n\t}\n\trender() {\n\t\treturn <GenericComponent\n\t\t\tcanvasToDraw={this.props.selectCanvas}\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tdrawOn={[]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { chartConfig } = moreProps;\n\n\t\treturn <LabelAnnotation yScale={getYScale(chartConfig)} {...this.props} text={getText(this.props)}/>;\n\t}\n}\n\nfunction getText(props) {\n\treturn functor(props.text)(props);\n}\n\nfunction getYScale(chartConfig) {\n\treturn Array.isArray(chartConfig) ? undefined : chartConfig.yScale;\n}\n\nLabel.propTypes = {\n\tclassName: PropTypes.string,\n\tselectCanvas: PropTypes.func,\n\ttext: PropTypes.oneOfType([\n\t\tPropTypes.string,\n\t\tPropTypes.func\n\t]).isRequired,\n\ttextAnchor: PropTypes.string,\n\tfontFamily: PropTypes.string,\n\tfontSize: PropTypes.number,\n\topacity: PropTypes.number,\n\trotate: PropTypes.number,\n\tonClick: PropTypes.func,\n\txAccessor: PropTypes.func,\n\txScale: PropTypes.func,\n\tyScale: PropTypes.func,\n\tdatum: PropTypes.object,\n\tx: PropTypes.oneOfType([\n\t\tPropTypes.number,\n\t\tPropTypes.func\n\t]),\n\ty: PropTypes.oneOfType([\n\t\tPropTypes.number,\n\t\tPropTypes.func\n\t])\n};\n\nLabel.contextTypes = {\n\tcanvasOriginX: PropTypes.number,\n\tcanvasOriginY: PropTypes.number,\n\n\tmargin: PropTypes.object.isRequired,\n\tratio: PropTypes.number.isRequired,\n};\n\nLabel.defaultProps = {\n\t...defaultProps,\n\tselectCanvas: canvases => canvases.bg,\n};\n\nfunction drawOnCanvas2(ctx, props, context, moreProps) {\n\tctx.save();\n\n\tconst { canvasOriginX, canvasOriginY, margin, ratio } = context;\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\tctx.scale(ratio, ratio);\n\n\n\tif (isDefined(canvasOriginX))\n\t\tctx.translate(canvasOriginX, canvasOriginY);\n\telse\n\t\tctx.translate(margin.left + (0.5 * ratio), margin.top + (0.5 * ratio));\n\n\tdrawOnCanvas(ctx, props, moreProps);\n\n\tctx.restore();\n\n}\n\nfunction drawOnCanvas(ctx, props, moreProps) {\n\tconst { textAnchor, fontFamily, fontSize, opacity, rotate } = props;\n\tconst { xScale, chartConfig, xAccessor } = moreProps;\n\n\tconst { xPos, yPos, fill, text } = helper(props, xAccessor, xScale, getYScale(chartConfig));\n\n\tconst radians = (rotate / 180) * Math.PI;\n\tctx.save();\n\tctx.translate(xPos, yPos);\n\tctx.rotate(radians);\n\n\tctx.font = `${ fontSize }px ${ fontFamily }`;\n\tctx.fillStyle = hexToRGBA(fill, opacity);\n\tctx.textAlign = textAnchor === \"middle\" ? \"center\" : textAnchor;\n\n\tctx.beginPath();\n\tctx.fillText(text, 0, 0);\n\tctx.restore();\n}\n\n\nexport default Label;\n"]}