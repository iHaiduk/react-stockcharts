{"version":3,"sources":["../../../src/lib/annotation/Label.js"],"names":["Label","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","drawOnCanvas2","context","selectCanvas","chartConfig","getYScale","getText","text","Array","isArray","undefined","yScale","contextTypes","canvasOriginX","number","canvasOriginY","margin","object","isRequired","ratio","defaultProps","canvases","bg","save","setTransform","scale","translate","left","top","restore","textAnchor","fontFamily","fontSize","opacity","rotate","xScale","xAccessor","xPos","yPos","fill","radians","Math","PI","font","fillStyle","textAlign","beginPath","fillText"],"mappings":"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","file":"Label.js","sourcesContent":["\"use strict\";\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport GenericComponent from \"../GenericComponent\";\n\nimport { isDefined, hexToRGBA, functor } from \"../utils\";\nimport LabelAnnotation, { defaultProps, helper } from \"./LabelAnnotation\";\n\nclass Label extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tdrawOnCanvas2(ctx, this.props, this.context, moreProps);\n\t}\n\trender() {\n\t\treturn <GenericComponent\n\t\t\tcanvasToDraw={this.props.selectCanvas}\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tdrawOn={[]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { chartConfig } = moreProps;\n\n\t\treturn <LabelAnnotation yScale={getYScale(chartConfig)} {...this.props} text={getText(this.props)}/>;\n\t}\n}\n\nfunction getText(props) {\n\treturn functor(props.text)(props);\n}\n\nfunction getYScale(chartConfig) {\n\treturn Array.isArray(chartConfig) ? undefined : chartConfig.yScale;\n}\n\nLabel.propTypes = {\n\tclassName: PropTypes.string,\n\tselectCanvas: PropTypes.func,\n\ttext: PropTypes.oneOfType([\n\t\tPropTypes.string,\n\t\tPropTypes.func\n\t]).isRequired,\n\ttextAnchor: PropTypes.string,\n\tfontFamily: PropTypes.string,\n\tfontSize: PropTypes.number,\n\topacity: PropTypes.number,\n\trotate: PropTypes.number,\n\tonClick: PropTypes.func,\n\txAccessor: PropTypes.func,\n\txScale: PropTypes.func,\n\tyScale: PropTypes.func,\n\tdatum: PropTypes.object,\n\tx: PropTypes.oneOfType([\n\t\tPropTypes.number,\n\t\tPropTypes.func\n\t]),\n\ty: PropTypes.oneOfType([\n\t\tPropTypes.number,\n\t\tPropTypes.func\n\t])\n};\n\nLabel.contextTypes = {\n\tcanvasOriginX: PropTypes.number,\n\tcanvasOriginY: PropTypes.number,\n\n\tmargin: PropTypes.object.isRequired,\n\tratio: PropTypes.number.isRequired,\n};\n\nLabel.defaultProps = {\n\t...defaultProps,\n\tselectCanvas: canvases => canvases.bg,\n};\n\nfunction drawOnCanvas2(ctx, props, context, moreProps) {\n\tctx.save();\n\n\tconst { canvasOriginX, canvasOriginY, margin, ratio } = context;\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\tctx.scale(ratio, ratio);\n\n\n\tif (isDefined(canvasOriginX))\n\t\tctx.translate(canvasOriginX, canvasOriginY);\n\telse\n\t\tctx.translate(margin.left + (0.5 * ratio), margin.top + (0.5 * ratio));\n\n\tdrawOnCanvas(ctx, props, moreProps);\n\n\tctx.restore();\n\n}\n\nfunction drawOnCanvas(ctx, props, moreProps) {\n\tconst { textAnchor, fontFamily, fontSize, opacity, rotate } = props;\n\tconst { xScale, chartConfig, xAccessor } = moreProps;\n\n\tconst { xPos, yPos, fill, text } = helper(props, xAccessor, xScale, getYScale(chartConfig));\n\n\tconst radians = (rotate / 180) * Math.PI;\n\tctx.save();\n\tctx.translate(xPos, yPos);\n\tctx.rotate(radians);\n\n\tctx.font = `${ fontSize }px ${ fontFamily }`;\n\tctx.fillStyle = hexToRGBA(fill, opacity);\n\tctx.textAlign = textAnchor === \"middle\" ? \"center\" : textAnchor;\n\n\tctx.beginPath();\n\tctx.fillText(text, 0, 0);\n\tctx.restore();\n}\n\n\nexport default Label;\n"]}